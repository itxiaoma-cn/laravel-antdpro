"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[164],{10442:function(ie,b,r){var H=r(15009),m=r.n(H),N=r(99289),c=r.n(N),X=r(5574),I=r.n(X),Z=r(67294),g=r(2618),x=function(J){var V=(0,Z.useState)([]),K=I()(V,2),T=K[0],C=K[1],$=function(){var k=c()(m()().mark(function v(){var A;return m()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(0,g.et)(J,{pageSize:1e4});case 2:A=O.sent,A.success&&C(A.data);case 4:case"end":return O.stop()}},v)}));return function(){return k.apply(this,arguments)}}();return(0,Z.useEffect)(function(){$().catch(console.error)},[]),{items:T,setItems:C}};b.Z=x},79604:function(ie,b,r){r.r(b),r.d(b,{default:function(){return Me}});var H=r(5574),m=r.n(H),N=r(15009),c=r.n(N),X=r(97857),I=r.n(X),Z=r(99289),g=r.n(Z),x=r(2618),se=r(51042),J=r(6110),V=r(8849),K=r(2236),T=r(33345),C=r(2453),$=r(71577),k=r(36147),v=r(67294),A=r(96695),_=r.n(A),O=r(34994),de=r(5966),w=r(5298),ce=r(14e3),me=r(10442),n=r(85893),ve=function(a){var t,u=a.form,s=a.permissions,e=(0,v.useState)([]),S=m()(e,2),F=S[0],f=S[1],q=(0,v.useState)((t=s==null?void 0:s.map(function(l){return l.id}))!==null&&t!==void 0?t:[]),D=m()(q,2),ee=D[0],B=D[1],P=(0,v.useState)([]),L=m()(P,2),U=L[0],W=L[1],R=(0,v.useState)(!0),G=m()(R,2),Q=G[0],E=G[1],re=(0,me.Z)("/permissions/groups"),le=re.items,z=function(i){f(i),E(!0)},p=function(i,h){B(i);var o=[];if(Array.isArray(i)){var j=_()(i),M;try{for(j.s();!(M=j.n()).done;){var ne=M.value;o.push(ne)}}catch(ae){j.e(ae)}finally{j.f()}}if(Array.isArray(h.halfCheckedKeys)){var Y=_()(h.halfCheckedKeys),oe;try{for(Y.s();!(oe=Y.n()).done;){var xe=oe.value;o.push(xe)}}catch(ae){Y.e(ae)}finally{Y.f()}}console.log("permission_ids",o),u.setFieldsValue({permission_ids:o})},d=function(i,h){console.log("onSelect",h),W(i)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(O.A.Group,{children:(0,n.jsx)(de.Z,{rules:[{required:!0,message:"\u8BF7\u8F93\u5165"}],width:"md",label:"\u540D\u79F0",name:"name"})}),(0,n.jsx)(O.A.Group,{children:(0,n.jsx)(w.Z.Item,{name:"permission_ids",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{children:"\u9009\u62E9\u6743\u9650"}),(0,n.jsx)(ce.Z,{checkable:!0,defaultExpandAll:!0,onExpand:z,expandedKeys:F,autoExpandParent:Q,onCheck:p,checkedKeys:ee,onSelect:d,selectedKeys:U,treeData:le})]})})})]})},te=ve,ue=r(37476),fe=r(96365),pe=function(a){var t=a.updateModalOpen,u=a.onCancel,s=a.onSubmit,e=a.values,S=w.Z.useForm(),F=m()(S,1),f=F[0];return(0,n.jsxs)(ue.Y,{form:f,title:"\u4FEE\u6539\u89D2\u8272",width:"50%",modalProps:{destroyOnClose:!0,maskClosable:!1},open:t,onOpenChange:u,onFinish:s,initialValues:I()({},e),children:[(0,n.jsx)(te,{permissions:e.permissions,form:f}),(0,n.jsx)(w.Z.Item,{name:"id",label:!1,children:(0,n.jsx)(fe.Z,{type:"hidden"})})]})},he=pe,Se=function(a){var t=w.Z.useForm(),u=m()(t,1),s=u[0],e=a.open,S=a.onOpenChange,F=a.onFinish;return(0,n.jsx)(ue.Y,{form:s,title:"\u65B0\u589E\u89D2\u8272",width:"50%",open:e,onOpenChange:S,modalProps:{destroyOnClose:!0,maskClosable:!1},onFinish:F,children:(0,n.jsx)(te,{form:s})})},ge=Se,ye=r(31991),je=r(85265),Ce=function(a){var t=a.onClose,u=a.open,s=a.currentRow,e=a.columns;return(0,n.jsx)(je.Z,{width:"70%",open:u,onClose:t,closable:!1,children:(s==null?void 0:s.name)&&(0,n.jsx)(ye.vY,{column:2,title:s==null?void 0:s.name,request:g()(c()().mark(function S(){return c()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",{data:s||{}});case 1:case"end":return f.stop()}},S)})),params:{id:s==null?void 0:s.name},columns:e})})},Ee=Ce,Oe=function(){var y=g()(c()().mark(function a(t){var u;return c()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=C.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),e.prev=1,e.next=4,(0,x.jX)("/roles",I()({},t));case 4:return u(),C.ZP.success("\u6DFB\u52A0\u6210\u529F"),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(1),u(),e.abrupt("return",!1);case 13:case"end":return e.stop()}},a,null,[[1,9]])}));return function(t){return y.apply(this,arguments)}}(),Fe=function(){var y=g()(c()().mark(function a(t){var u;return c()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=C.ZP.loading("\u6B63\u5728\u66F4\u65B0"),e.prev=1,e.next=4,(0,x.$G)("/roles/".concat(t.id),t);case 4:return u(),C.ZP.success("\u66F4\u65B0\u6210\u529F"),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(1),u(),e.abrupt("return",!1);case 13:case"end":return e.stop()}},a,null,[[1,9]])}));return function(t){return y.apply(this,arguments)}}(),Pe=function(){var y=g()(c()().mark(function a(t){var u;return c()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u=C.ZP.loading("\u6B63\u5728\u5220\u9664"),t){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,e.next=6,(0,x.cl)("/roles",{ids:t});case 6:return u(),C.ZP.success("Deleted successfully and will refresh soon"),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(3),u(),e.abrupt("return",!1);case 15:case"end":return e.stop()}},a,null,[[3,11]])}));return function(t){return y.apply(this,arguments)}}(),Te=function(){var a=(0,v.useState)(!1),t=m()(a,2),u=t[0],s=t[1],e=(0,v.useState)(!1),S=m()(e,2),F=S[0],f=S[1],q=(0,v.useState)(!1),D=m()(q,2),ee=D[0],B=D[1],P=(0,v.useRef)(),L=(0,v.useState)(),U=m()(L,2),W=U[0],R=U[1],G=(0,v.useState)([]),Q=m()(G,2),E=Q[0],re=Q[1],le=(0,T.useAccess)(),z=[{title:"\u540D\u79F0",width:200,dataIndex:"name",render:function(d,l){return l.id!==1?(0,n.jsx)("a",{onClick:function(){R(l),B(!0)},children:d}):d}},{title:"\u6743\u9650\u5217\u8868",dataIndex:"permissions",renderText:function(d){return d.map(function(l){return l.name}).join(", ")},hideInSearch:!0,hideInTable:!0},{title:"\u521B\u5EFA\u65F6\u95F4",width:250,hideInSearch:!0,dataIndex:"created_at",valueType:"date"},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",fixed:"right",render:function(d,l){return[l.id!==1&&(0,n.jsx)("a",{onClick:function(){f(!0),R(l)},children:"\u7F16\u8F91"},"update")]}}];return(0,n.jsxs)(J._z,{children:[(0,n.jsx)(V.Z,{headerTitle:"\u89D2\u8272\u7BA1\u7406",actionRef:P,rowKey:"id",search:{labelWidth:120},pagination:{defaultPageSize:10},toolBarRender:function(){return[(0,n.jsxs)($.ZP,{type:"primary",onClick:function(){s(!0)},children:[(0,n.jsx)(se.Z,{})," ",(0,n.jsx)(T.FormattedMessage,{id:"pages.searchTable.new",defaultMessage:"New"})]},"primary")]},request:function(){var p=g()(c()().mark(function d(l,i,h){return c()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",(0,x.et)("/roles",l,i,h));case 1:case"end":return j.stop()}},d)}));return function(d,l,i){return p.apply(this,arguments)}}(),columns:z,rowSelection:!1}),(E==null?void 0:E.length)>0&&(0,n.jsx)(K.S,{extra:(0,n.jsxs)("div",{children:[(0,n.jsx)(T.FormattedMessage,{id:"pages.searchTable.chosen",defaultMessage:"Chosen"})," ",(0,n.jsx)("a",{style:{fontWeight:600},children:E.length})," ",(0,n.jsx)(T.FormattedMessage,{id:"pages.searchTable.item",defaultMessage:"\u9879"})]}),children:(0,n.jsx)($.ZP,{type:"primary",danger:!0,onClick:function(){return k.Z.confirm({title:"\u786E\u8BA4\u5220\u9664?",onOk:function(){var d=g()(c()().mark(function i(){var h,o;return c()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,Pe(E==null?void 0:E.map(function(ne){return ne.id}));case 2:re([]),(h=P.current)===null||h===void 0||(o=h.reloadAndRest)===null||o===void 0||o.call(h);case 4:case"end":return M.stop()}},i)}));function l(){return d.apply(this,arguments)}return l}(),content:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88"})},children:(0,n.jsx)(T.FormattedMessage,{id:"pages.searchTable.batchDeletion",defaultMessage:"Batch deletion"})})}),(0,n.jsx)(ge,{open:u,onOpenChange:s,onFinish:function(){var p=g()(c()().mark(function d(l){var i;return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Oe(l);case 2:i=o.sent,i&&(s(!1),P.current&&P.current.reload());case 4:case"end":return o.stop()}},d)}));return function(d){return p.apply(this,arguments)}}()}),(0,n.jsx)(he,{onSubmit:function(){var p=g()(c()().mark(function d(l){var i;return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Fe(l);case 2:i=o.sent,i&&(f(!1),R(void 0),P.current&&P.current.reload());case 4:case"end":return o.stop()}},d)}));return function(d){return p.apply(this,arguments)}}(),onCancel:f,updateModalOpen:F,values:W||{}}),(0,n.jsx)(Ee,{open:ee,currentRow:W,columns:z,onClose:function(){R(void 0),B(!1)}})]})},Me=Te}}]);
